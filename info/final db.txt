VERSION 1

create table users(
id int(10) unsigned primary key auto_increment,
u_id varchar(100) not null,
u_pw varchar(200) not null,
u_bday timestamp not null,
last_login timestamp not null default current_timestamp,
sex char(2) not null,
email varchar(255) not null,
verification tinyint(1) not null default 0,
vcode varchar(10) default null,
present_login timestamp not null default current_timestamp,
fulltext key(u_id)
);

CREATE TABLE `penobrol` (
  `id` int(10) unsigned PRIMARY KEY AUTO_INCREMENT,
  `title` varchar(255) NOT NULL,
  `thumbnail` varchar(255),
  `content` text NOT NULL,
  `author` int(10) unsigned,
  `p_view` int(10) unsigned NOT NULL DEFAULT '0',
  `date` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `public` char(2) DEFAULT 'p',
  `warning` int(10) unsigned NOT NULL DEFAULT '0',
  `changed_date` timestamp,
  `score` decimal(11,2) NOT NULL DEFAULT '0.00'
  FULLTEXT KEY `search` (`title`,`content`),
  FULLTEXT KEY `title` (`title`),
  FULLTEXT KEY `content` (`content`),
  FOREIGN KEY(author) 
    REFERENCES users(id)
    ON DELETE SET NULL
);

CREATE TABLE `tandya` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `question` varchar(255) NOT NULL,
  `thumbnail` varchar(255),
  `content` text NOT NULL,
  `author` int(10) unsigned,
  `t_view` int(10) unsigned DEFAULT 0,
  `date` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `public` char(2) DEFAULT 'p',
  `warning` int(10) unsigned NOT NULL DEFAULT '0',
  `changed_date` timestamp,
  `score` decimal(11,2) NOT NULL DEFAULT '0.00'
  PRIMARY KEY (`id`),
  FULLTEXT KEY `question` (`question`),
  FULLTEXT KEY `content` (`content`),
  FULLTEXT KEY `search` (`question`,`content`),
  FOREIGN KEY(author) 
    REFERENCES users(id)
    ON DELETE SET NULL
);

CREATE TABLE penobrol_hashtag (
  `id` int(10) unsigned PRIMARY KEY AUTO_INCREMENT,
  p_id int(10) unsigned NOT NULL,
  hash varchar(50) NOT NULL,
  FOREIGN KEY(p_id) 
    REFERENCES penobrol(id)
    ON DELETE CASCADE
);

CREATE TABLE tandya_hashtag (
  `id` int(10) unsigned PRIMARY KEY AUTO_INCREMENT,
  t_id int(10) unsigned NOT NULL,
  hash varchar(50) NOT NULL,
  FOREIGN KEY(t_id) 
    REFERENCES penobrol(id)
    ON DELETE CASCADE
);

VERSION 1.1
alter table ...

create table...

update version set v=1.1;
